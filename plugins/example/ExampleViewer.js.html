<html>
  <head>
    <base href="../.."/>
    <title>doctus - ExampleViewer.js</title>

    <link rel="stylesheet" href="public/github-markdown.min-05fea8df8ec68cb6c27337f6db65733e.css">
    <link rel="stylesheet" href="public/highlight-c281e701b2830b095c67417cd9a7b210.css">
    <link rel="stylesheet" href="public/style-aea3468ccb7ee0c3c4c2b5d339fc989e.css">

    <script src="~/plugins/core/example/ExampleViewer.js"></script>
  </head>
  <body class="markdown-body flex-column">
    <div class="header flex">
      <a class="header-brand" href="./index.html">doctus</a>
      
<ul class="menu flex align-center justify-center">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/index.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Examples
      </a>
      
    </li>
    
  
</ul>
    </div>
      
      

<main class="flex-grow flex h-100">
  <div class="sidebar border-right mr-2 flex-noshrink">
  
<ul class="menu">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/index.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Examples
      </a>
      
        
<ul class="menu">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/code-preview.html"
        
        
      >
        Code Preview
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/components/index.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Components
      </a>
      
        
<ul class="menu">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/components/test.html"
        
        
      >
        Test
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/components/Panel.html"
        
        
      >
        Panel
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/components/Button.html"
        
        
      >
        Button
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/components/OutlineButton.html"
        
        
      >
        OutlineButton
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/components/Base.html"
        
        
      >
        Base
      </a>
      
    </li>
    
  
</ul>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/forms/index.html"
        
        
          role="button"
          
          aria-expanded="false"
        
      >
        Forms
      </a>
      
        
<ul class="menu">
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/forms/TextField.html"
        
        
      >
        TextField
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/forms/FormControl.html"
        
        
      >
        FormControl
      </a>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/forms/CheckboxControl.html"
        
        
      >
        CheckboxControl
      </a>
      
    </li>
    
  
</ul>
      
    </li>
    
  
    
    <li class="menu-item">
      <a 
        class="menu-link"
        
          href="examples/utils/index.html"
        
        
      >
        Utils
      </a>
      
    </li>
    
  
</ul>
      
    </li>
    
  
</ul>
</div>
  <div class="flex-grow">
    <div class="container py-4">
      <h1>Source: ExampleViewer.js</h1>
      <p>
        plugins/example/ExampleViewer.js
      </p>
      
      <pre><code class="hljs">(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title class_">Element</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">querySelector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(<span class="hljs-title class_">Element</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">querySelector</span>, {
    <span class="hljs-title function_">apply</span>(<span class="hljs-params">target, thisArg, args, receiver</span>) {
      <span class="hljs-keyword">const</span> el = shadowHosts.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, host</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> acc || host.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(...args);
      }, <span class="hljs-literal">null</span>);

      <span class="hljs-keyword">if</span> (el) {
        <span class="hljs-keyword">return</span> el;
      }

      <span class="hljs-keyword">return</span> target.<span class="hljs-title function_">apply</span>(thisArg, args, receiver);
    }
  });

  <span class="hljs-keyword">const</span> shadowHosts = [];

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">addShadowHost</span> = (<span class="hljs-params">host</span>) =&gt; {
    shadowHosts.<span class="hljs-title function_">push</span>(host);
  }

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">removeShadowHost</span> = (<span class="hljs-params">host</span>) =&gt; {
    shadowHosts = shadowHosts.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">h</span>) =&gt;</span> h !== host);
  }

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getDocumentProxy</span> = (<span class="hljs-params"><span class="hljs-variable language_">document</span></span>) =&gt; {
    
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">querySelector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">querySelector</span>, {
      <span class="hljs-title function_">apply</span>(<span class="hljs-params">target, thisArg, args, receiver</span>) {
        <span class="hljs-keyword">const</span> el = shadowHosts.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, host</span>) =&gt;</span> {
          <span class="hljs-keyword">return</span> acc || host.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">querySelector</span>(...args);
        }, <span class="hljs-literal">null</span>);
  
        <span class="hljs-keyword">if</span> (el) {
          <span class="hljs-keyword">return</span> el;
        }
  
        <span class="hljs-keyword">return</span> target.<span class="hljs-title function_">apply</span>(thisArg, args, receiver);
      }
    });
  
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">querySelectorAll</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">querySelectorAll</span>, {
      <span class="hljs-title function_">apply</span>(<span class="hljs-params">target, thisArg, args, receiver</span>) {
        <span class="hljs-keyword">const</span> el = shadowHosts.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, host</span>) =&gt;</span> {
          <span class="hljs-keyword">return</span> acc || host.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">querySelectorAll</span>(...args);
        }, <span class="hljs-literal">null</span>);
  
        <span class="hljs-keyword">if</span> (el) {
          <span class="hljs-keyword">return</span> el;
        }
  
        <span class="hljs-keyword">return</span> target.<span class="hljs-title function_">apply</span>(thisArg, args, receiver);
      }
    });
    
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">addEventListener</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">addEventListener</span>, {
      <span class="hljs-title function_">apply</span>(<span class="hljs-params">target, thisArg, args, receiver</span>) {
        <span class="hljs-keyword">const</span> [ <span class="hljs-keyword">type</span>, listener, options ] = args;

        <span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span> = (<span class="hljs-params">e</span>) =&gt; {
          <span class="hljs-keyword">const</span> host = shadowHosts.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">host</span>) =&gt;</span> e.<span class="hljs-title function_">composedPath</span>().<span class="hljs-title function_">includes</span>(host));
  
          <span class="hljs-keyword">if</span> (host) {
            <span class="hljs-keyword">const</span> orig = e.<span class="hljs-title function_">composedPath</span>()[<span class="hljs-number">0</span>];
            
            e = {
              ...e,
              <span class="hljs-attr">target</span>: orig,
              <span class="hljs-attr">currentTarget</span>: orig
            }
          }
  
          <span class="hljs-title function_">listener</span>(e);
        }
  
        <span class="hljs-keyword">return</span> target.<span class="hljs-title function_">apply</span>(thisArg, [ <span class="hljs-keyword">type</span>, fn, options ], receiver);
      }
    });
  };

  globalThis.<span class="hljs-property">document</span> = <span class="hljs-title function_">getDocumentProxy</span>(globalThis.<span class="hljs-property">document</span>);
  
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExampleViewer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
      <span class="hljs-variable language_">super</span>();
  
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachShadow</span>({ <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;open&quot;</span> });

      <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;style&#x27;</span>);

      style.<span class="hljs-property">textContent</span> = <span class="hljs-string">`
        :host {
          display: block;
          height: auto !important;
        }

        :host &gt; .example-body {
          min-height: 0 !important;
          display: block !important;
        }
      `</span>;

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(style);
      
      <span class="hljs-title function_">addShadowHost</span>(<span class="hljs-variable language_">this</span>);
    }

    <span class="hljs-title function_">connectedCallback</span>(<span class="hljs-params"></span>) {
      <span class="hljs-keyword">const</span> templateSelector = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&quot;template&quot;</span>);
      <span class="hljs-keyword">const</span> template = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(templateSelector);
  
      <span class="hljs-keyword">if</span> (!template) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;Template not found&quot;</span>, templateSelector);
        <span class="hljs-keyword">return</span>;
      }
  
      <span class="hljs-keyword">const</span> content = template.<span class="hljs-property">content</span>.<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>);
  
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">shadowRoot</span>.<span class="hljs-title function_">appendChild</span>(content);
    }

    <span class="hljs-title function_">disconnectedCallback</span>(<span class="hljs-params"></span>) {
      <span class="hljs-title function_">removeShadowHost</span>(<span class="hljs-variable language_">this</span>);
    }
  }
  
  customElements.<span class="hljs-title function_">define</span>(<span class="hljs-string">&#x27;example-viewer&#x27;</span>, <span class="hljs-title class_">ExampleViewer</span>);
})();</code></pre>
    </div>
  </div>
</main>

    <div class="footer">
      <div class="center">
        &copy; 2018 <a href="https//benignware.com">Benignware</a>
      </div>
    </div>
  </body>
</html>